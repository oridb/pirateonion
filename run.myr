use std

pkg =
	const run	: (cmd : byte[:][:] -> std.waitstatus)
;;

const run = {cmd
	var pid
	var status

	pid = std.fork()
	if pid == -1
		std.fatal(1, "could not fork command\n")
	elif pid == 0
		if std.execvp(cmd[0], cmd) < 0
			std.fatal(1, "failed to exec %s\n", cmd[0])
		;;
	else
		std.waitpid(pid, &status, 0)
	;;
	-> std.waitstatus(status)
}

