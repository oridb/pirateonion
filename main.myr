use std

use "master.use"
use "msg.use"
use "opts.use"
use "slave.use"

const main = {args
	var ctx

	ctx = std.optinit("h", args)
	while !std.optdone(ctx)
		match std.optnext(ctx)
		| ('h', _):	usage(args[0])
		;;
	;;

	opt_dirs = ["."][:]
	/*loadconfig()*/
	if opt_master
		master()
	else
		slave()
	;;
}

const usage = {bin
	std.put("%s [-h]\n")
	std.put("\tPirate onion. Arr-chives your files.\n")
	std.put("\t-h\tprint this help\n")
}

